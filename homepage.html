<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta http-equiv="X-UA-Compatible" content="ie=edge">
		<title>Calendar</title>
		<!-- <link rel="stylesheet" type="text/css" href="stylesheet.css"> -->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
		<!-- <script src="checkLogin.js"></script>
		<script src="login.js"></script>
		<script src="create.js"></script>
		<script src="hidden.js"></script>
		<script src="show.js"></script>
		<script src="createEvent.js"></script> -->

	</head>
	<body>
		<!-- <div class="show" style="display: none">
			<h1 id="welcome"></h1>
		</div>
		<div class="hidden">
			Username: <input type="text" id="new_user"><br>
			Password: <input type="password" id="new_password"><br>
			Confirm Password: <input type="password" id="confirm"><br>
			<button class="button" type="submit" id="create_btn">Create User</button><br>
			<br>
			Username: <input type="text" id="user"><br>
			Password: <input type="password" id="password"><br>
			<button class="button" type="submit" id="login">Login</button><br>
			<br>
		</div> -->

<script>

function createLogin() {
	let $login = $('<div>', {'class': 'login'});

	$login.append("Username: ");
	let $newUserField = $("<input>", {type: 'text', id: 'new_user'});
	$login.append($newUserField);
	$login.append("<br>");

	$login.append("Password: ");
	let $newPasswordField = $("<input>", {type: 'password', id: 'new_password'});
	$login.append($newPasswordField);
	$login.append("<br>");

	$login.append("Confirm Password: ");
	let $confirmField = $("<input>", {type: 'password', id: 'confirm'});
	$login.append($confirmField);
	$login.append("<br>");

	let $createButton = $("<button>", {'class':'button', type:'submit', id:'create_btn', text:'Create User'});
	$login.append($createButton);
	$login.append("<br>");
	$login.append("<br>");

	$login.append("Username: ");
	let $userField = $("<input>", {type: 'text', id: 'user'});
	$login.append($userField);
	$login.append("<br>");

	$login.append("Password: ");
	let $passwordField = $("<input>", {type: 'password', id: 'password'});
	$login.append($passwordField);
	$login.append("<br>");

	let $loginButton = $("<button>", {'class':'button', type:'submit', id:'login', text:'Login'});
	$login.append($loginButton);

	$(document.body).html($login);
}

let user_id = 1;
let month = 2;
let year = 2019;
let date = new Date(year, month);


function getNumberOfDays(date) {
	return new Date(date.getFullYear(), date.getMonth()+1, 0).getDate();
}

function createCalendar(user_id, date) {
	let $calendar = $("<div>", {'class':'calendar', text:'These are your events for the month'});
	let days_in_month = getNumberOfDays(date);
	$(document.body).append($calendar);
	for (day = 1; day <= days_in_month; day++) {
		date.setDate(day);
		//$calendar.append("<br>");
		fetchEvents(user_id, date);
	}
	//$(document.body).append($calendar);
}

function getDayName(date) {
	switch (date.getDay()) {
		case 0:
			return "Sunday";
		case 1:
			return "Monday";
		case 2:
			return "Tuesday";
		case 3:
			return "Wednesday";
		case 4:
			return "Thursday";
		case 5:
			return "Friday";
		case 6:
			return "Saturday";
	}
	return "";
}

function fetchEvents(user_id, date) {
	const date_string = date.toISOString().substring(0,10);
	const php_path = "get_events.php";
	const data = { "user_id": user_id, "date": date_string };
	let $day = $("<div>");
	fetch(php_path, {method: "POST", body: JSON.stringify(data)})
		.then(response => response.json())
		.then(function(events) {
			
			$day = $("<div>", {'class':'day', text:date_string});
			for (i in events) {				
				let event_text = events[i].title;
				$event = $("<h3>", {'class':'event', text:event_text});
				$day.append($event);
			}
			console.log($day);
			//return $day;
			//$(document.body).append($day);
			$( ".calendar" ).append($day);
		})
		.catch(function(error) {
			console.log(error);
		});
	//return $day;
}

createLogin();
createCalendar(user_id, date);
				
</script>





			<!-- <div class="show" style="display: none">
				Title: <input type="text" id="event"><br>
				Date: <input type="date" id="date"><br>
				Time: <input type="time" id="time"><br>
				<button class="button" type="submit" id="event_btn">Create Event</button><br>
			</div>


			<div class="show" style="display: none">
				<a href="abort.php" class="button">Logout</a>
			</div>




	</body>
</html>

